/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package com.mycompany.quanlynhanvien.ui;

import com.mycompany.quanlynhanvien.Dao.NhanVienDao;
import com.mycompany.quanlynhanvien.Dao.NhomSanPhamDao;
import com.mycompany.quanlynhanvien.Dao.TacGiaDao;
import com.mycompany.quanlynhanvien.Helpers.ConnectDB;
import com.mycompany.quanlynhanvien.Helpers.DataValidator;
import com.mycompany.quanlynhanvien.Helpers.ImageHelper;
import com.mycompany.quanlynhanvien.Helpers.MessageDialogHelper;
import com.mycompany.quanlynhanvien.model.NhanVien;
import com.mycompany.quanlynhanvien.model.NhomSanPham;
import com.mycompany.quanlynhanvien.model.TacGia;
import com.toedter.calendar.JDateChooser;
import java.awt.Color;
import java.awt.HeadlessException;
import java.awt.Image;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JTextField;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author User
 */
public class TacGiaForm extends javax.swing.JPanel {
     private DefaultTableModel tblModel;
    /**
     * Creates new form TacGiaForm
     */
    public TacGiaForm() {
        initComponents();
        initTable();
        
        loadDataToTable();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        pn_TenForm_TacGia = new javax.swing.JPanel();
        lbl_TenForm_TacGia = new javax.swing.JLabel();
        pn_TTSP_TacGia = new javax.swing.JPanel();
        lbl_MaTG_TacGia = new javax.swing.JLabel();
        lbl_TenTG_TacGia = new javax.swing.JLabel();
        lbl_Quequan_TacGia = new javax.swing.JLabel();
        lbl_NgaySinh_TacGia = new javax.swing.JLabel();
        txt_QueQuan_TacGia = new javax.swing.JTextField();
        txt_MaTG_TacGia = new javax.swing.JTextField();
        txt_TenTG_TacGia = new javax.swing.JTextField();
        dc_NgaySinh_TacGia = new com.toedter.calendar.JDateChooser();
        scp_DanhSachTG_TacGia = new javax.swing.JScrollPane();
        tbl_DanhSachTG_TacGia = new javax.swing.JTable();
        pn_ChucNang_TacGia = new javax.swing.JPanel();
        btn_ThemTG_TacGia = new javax.swing.JButton();
        btn_Xoa_TacGia = new javax.swing.JButton();
        btn_CapNhap_TacGia = new javax.swing.JButton();
        btn_CapNhapBang_TacGia = new javax.swing.JButton();
        btn_XoaTT_TacGia = new javax.swing.JButton();
        pn_TimKiem_TacGia = new javax.swing.JPanel();
        lbl_NhapMa_TacGia = new javax.swing.JLabel();
        txt_MaTG_TK_TacGia = new javax.swing.JTextField();
        lbl_TenTG_TK_TacGia = new javax.swing.JLabel();
        btn_TimKiem_TK_TacGia = new javax.swing.JButton();
        dc_NgaySinh_TK_TacGia = new com.toedter.calendar.JDateChooser();

        setPreferredSize(new java.awt.Dimension(1341, 745));

        lbl_TenForm_TacGia.setBackground(new java.awt.Color(255, 255, 255));
        lbl_TenForm_TacGia.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        lbl_TenForm_TacGia.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lbl_TenForm_TacGia.setText("Tác Giả");
        lbl_TenForm_TacGia.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        javax.swing.GroupLayout pn_TenForm_TacGiaLayout = new javax.swing.GroupLayout(pn_TenForm_TacGia);
        pn_TenForm_TacGia.setLayout(pn_TenForm_TacGiaLayout);
        pn_TenForm_TacGiaLayout.setHorizontalGroup(
            pn_TenForm_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_TenForm_TacGiaLayout.createSequentialGroup()
                .addComponent(lbl_TenForm_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 1280, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 20, Short.MAX_VALUE))
        );
        pn_TenForm_TacGiaLayout.setVerticalGroup(
            pn_TenForm_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(lbl_TenForm_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, 42, Short.MAX_VALUE)
        );

        pn_TTSP_TacGia.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Thông tin sản phẩm", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 12))); // NOI18N

        lbl_MaTG_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_MaTG_TacGia.setText("Mã sản phẩm:");

        lbl_TenTG_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_TenTG_TacGia.setText("Tên sản phẩm:");

        lbl_Quequan_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_Quequan_TacGia.setText("Quê quán:");

        lbl_NgaySinh_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_NgaySinh_TacGia.setText("Ngày sinh:");

        txt_QueQuan_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        txt_QueQuan_TacGia.setMinimumSize(new java.awt.Dimension(7, 25));
        txt_QueQuan_TacGia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txt_QueQuan_TacGiaActionPerformed(evt);
            }
        });

        txt_MaTG_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        txt_MaTG_TacGia.setMinimumSize(new java.awt.Dimension(7, 25));

        txt_TenTG_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N

        dc_NgaySinh_TacGia.setDateFormatString("MM-dd-yyyy");

        javax.swing.GroupLayout pn_TTSP_TacGiaLayout = new javax.swing.GroupLayout(pn_TTSP_TacGia);
        pn_TTSP_TacGia.setLayout(pn_TTSP_TacGiaLayout);
        pn_TTSP_TacGiaLayout.setHorizontalGroup(
            pn_TTSP_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_TTSP_TacGiaLayout.createSequentialGroup()
                .addGap(41, 41, 41)
                .addGroup(pn_TTSP_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lbl_MaTG_TacGia)
                    .addComponent(lbl_NgaySinh_TacGia))
                .addGap(60, 60, 60)
                .addGroup(pn_TTSP_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(dc_NgaySinh_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, 350, Short.MAX_VALUE)
                    .addComponent(txt_MaTG_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(49, 49, 49)
                .addGroup(pn_TTSP_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lbl_TenTG_TacGia)
                    .addComponent(lbl_Quequan_TacGia))
                .addGap(60, 60, 60)
                .addGroup(pn_TTSP_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(txt_TenTG_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, 350, Short.MAX_VALUE)
                    .addComponent(txt_QueQuan_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addContainerGap(193, Short.MAX_VALUE))
        );
        pn_TTSP_TacGiaLayout.setVerticalGroup(
            pn_TTSP_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_TTSP_TacGiaLayout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addGroup(pn_TTSP_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbl_MaTG_TacGia)
                    .addComponent(txt_MaTG_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txt_TenTG_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lbl_TenTG_TacGia))
                .addGap(24, 24, 24)
                .addGroup(pn_TTSP_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addGroup(pn_TTSP_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                        .addComponent(txt_QueQuan_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                        .addComponent(lbl_Quequan_TacGia))
                    .addComponent(dc_NgaySinh_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(lbl_NgaySinh_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                .addGap(132, 132, 132))
        );

        tbl_DanhSachTG_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        tbl_DanhSachTG_TacGia.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null}
            },
            new String [] {
                "Mã NV", "Tên Nhân Viên", "Giới tính", "Ngày sinh", "Số điện thoại", "Chức vụ", "Tình trạng"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.Boolean.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        tbl_DanhSachTG_TacGia.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        tbl_DanhSachTG_TacGia.setName("Danh sách nhân viên\n"); // NOI18N
        tbl_DanhSachTG_TacGia.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                tbl_DanhSachTG_TacGiaFocusLost(evt);
            }
        });
        tbl_DanhSachTG_TacGia.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbl_DanhSachTG_TacGiaMouseClicked(evt);
            }
        });
        scp_DanhSachTG_TacGia.setViewportView(tbl_DanhSachTG_TacGia);

        btn_ThemTG_TacGia.setBackground(new java.awt.Color(51, 255, 51));
        btn_ThemTG_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_ThemTG_TacGia.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-identification-documents-24.png"))); // NOI18N
        btn_ThemTG_TacGia.setText("Thêm sản phẩm");
        btn_ThemTG_TacGia.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btn_ThemTG_TacGia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_ThemTG_TacGiaActionPerformed(evt);
            }
        });

        btn_Xoa_TacGia.setBackground(new java.awt.Color(51, 255, 51));
        btn_Xoa_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_Xoa_TacGia.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-user-24.png"))); // NOI18N
        btn_Xoa_TacGia.setText("-  Xóa sản phẩm");
        btn_Xoa_TacGia.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        btn_Xoa_TacGia.setMinimumSize(new java.awt.Dimension(93, 25));
        btn_Xoa_TacGia.setPreferredSize(new java.awt.Dimension(93, 25));
        btn_Xoa_TacGia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_Xoa_TacGiaActionPerformed(evt);
            }
        });

        btn_CapNhap_TacGia.setBackground(new java.awt.Color(102, 255, 102));
        btn_CapNhap_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_CapNhap_TacGia.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-pencil-24.png"))); // NOI18N
        btn_CapNhap_TacGia.setText("Cập nhập sản phẩm");
        btn_CapNhap_TacGia.setFocusable(false);
        btn_CapNhap_TacGia.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btn_CapNhap_TacGia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_CapNhap_TacGiaActionPerformed(evt);
            }
        });

        btn_CapNhapBang_TacGia.setBackground(new java.awt.Color(51, 255, 51));
        btn_CapNhapBang_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_CapNhapBang_TacGia.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-easel-24.png"))); // NOI18N
        btn_CapNhapBang_TacGia.setText("Cập nhập lại bảng");
        btn_CapNhapBang_TacGia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_CapNhapBang_TacGiaActionPerformed(evt);
            }
        });

        btn_XoaTT_TacGia.setBackground(new java.awt.Color(51, 255, 51));
        btn_XoaTT_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_XoaTT_TacGia.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-identification-documents-24.png"))); // NOI18N
        btn_XoaTT_TacGia.setText("Xóa thông tin");
        btn_XoaTT_TacGia.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btn_XoaTT_TacGia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_XoaTT_TacGiaActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pn_ChucNang_TacGiaLayout = new javax.swing.GroupLayout(pn_ChucNang_TacGia);
        pn_ChucNang_TacGia.setLayout(pn_ChucNang_TacGiaLayout);
        pn_ChucNang_TacGiaLayout.setHorizontalGroup(
            pn_ChucNang_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_ChucNang_TacGiaLayout.createSequentialGroup()
                .addGap(51, 51, 51)
                .addComponent(btn_XoaTT_TacGia)
                .addGap(95, 95, 95)
                .addComponent(btn_ThemTG_TacGia)
                .addGap(92, 92, 92)
                .addComponent(btn_Xoa_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 171, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(84, 84, 84)
                .addComponent(btn_CapNhap_TacGia)
                .addGap(68, 68, 68)
                .addComponent(btn_CapNhapBang_TacGia)
                .addContainerGap(javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
        );
        pn_ChucNang_TacGiaLayout.setVerticalGroup(
            pn_ChucNang_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_ChucNang_TacGiaLayout.createSequentialGroup()
                .addGap(8, 8, 8)
                .addGroup(pn_ChucNang_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btn_CapNhap_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn_CapNhapBang_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn_ThemTG_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn_Xoa_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn_XoaTT_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(8, 8, 8))
        );

        pn_TimKiem_TacGia.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Tìm kiếm", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 12))); // NOI18N

        lbl_NhapMa_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_NhapMa_TacGia.setText("Mã tác giả:");

        txt_MaTG_TK_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N

        lbl_TenTG_TK_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_TenTG_TK_TacGia.setText("Tên tác giả:");

        btn_TimKiem_TK_TacGia.setBackground(new java.awt.Color(51, 255, 51));
        btn_TimKiem_TK_TacGia.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_TimKiem_TK_TacGia.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-search-24.png"))); // NOI18N
        btn_TimKiem_TK_TacGia.setText("Tìm kiếm");
        btn_TimKiem_TK_TacGia.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_TimKiem_TK_TacGiaActionPerformed(evt);
            }
        });

        dc_NgaySinh_TK_TacGia.setDateFormatString("MM-dd-yyyy");

        javax.swing.GroupLayout pn_TimKiem_TacGiaLayout = new javax.swing.GroupLayout(pn_TimKiem_TacGia);
        pn_TimKiem_TacGia.setLayout(pn_TimKiem_TacGiaLayout);
        pn_TimKiem_TacGiaLayout.setHorizontalGroup(
            pn_TimKiem_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_TimKiem_TacGiaLayout.createSequentialGroup()
                .addGap(41, 41, 41)
                .addComponent(lbl_NhapMa_TacGia)
                .addGap(79, 79, 79)
                .addComponent(txt_MaTG_TK_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 349, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(54, 54, 54)
                .addComponent(lbl_TenTG_TK_TacGia)
                .addGap(78, 78, 78)
                .addComponent(dc_NgaySinh_TK_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, 350, Short.MAX_VALUE)
                .addGap(18, 18, 18)
                .addComponent(btn_TimKiem_TK_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 125, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(16, 16, 16))
        );
        pn_TimKiem_TacGiaLayout.setVerticalGroup(
            pn_TimKiem_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_TimKiem_TacGiaLayout.createSequentialGroup()
                .addGroup(pn_TimKiem_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pn_TimKiem_TacGiaLayout.createSequentialGroup()
                        .addGap(11, 11, 11)
                        .addGroup(pn_TimKiem_TacGiaLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                            .addComponent(lbl_NhapMa_TacGia)
                            .addComponent(txt_MaTG_TK_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                            .addComponent(lbl_TenTG_TK_TacGia)))
                    .addGroup(pn_TimKiem_TacGiaLayout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(dc_NgaySinh_TK_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                    .addComponent(btn_TimKiem_TK_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addContainerGap())
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                    .addComponent(pn_TimKiem_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(pn_ChucNang_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(pn_TTSP_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addComponent(pn_TenForm_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                    .addGroup(layout.createSequentialGroup()
                        .addContainerGap()
                        .addComponent(scp_DanhSachTG_TacGia)))
                .addContainerGap(41, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addComponent(pn_TenForm_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(pn_TimKiem_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(pn_TTSP_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(pn_ChucNang_TacGia, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(scp_DanhSachTG_TacGia, javax.swing.GroupLayout.DEFAULT_SIZE, 363, Short.MAX_VALUE)
                .addContainerGap())
        );
    }// </editor-fold>//GEN-END:initComponents

    private void txt_QueQuan_TacGiaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txt_QueQuan_TacGiaActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txt_QueQuan_TacGiaActionPerformed

    private void tbl_DanhSachTG_TacGiaFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_tbl_DanhSachTG_TacGiaFocusLost

    }//GEN-LAST:event_tbl_DanhSachTG_TacGiaFocusLost

    private void tbl_DanhSachTG_TacGiaMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbl_DanhSachTG_TacGiaMouseClicked
        try {
            int row = tbl_DanhSachTG_TacGia.getSelectedRow();
            //MessageDialogHelper.showConfirmDialog(null, ""+row, "Cảnh báo");
            if(row>=0)
            {
            String id = (String) tbl_DanhSachTG_TacGia.getValueAt(row, 0);
            TacGiaDao dao = new TacGiaDao();
            TacGia tg = dao.find(id);
            
            if(tg!=null)
            {
                txt_MaTG_TacGia.setText(tg.getMaTacGia().replaceAll("\\s",""));
                txt_TenTG_TacGia.setText(tg.getTenTacGia());
                Date ns0 = new SimpleDateFormat("yyyy-MM-dd").parse(tg.getNgaySinh());
                String ns1 = new SimpleDateFormat("MM-dd-yyyy").format(ns0);
                Date ns2 = new SimpleDateFormat("MM-dd-yyyy").parse(ns1);
                dc_NgaySinh_TacGia.setDate(ns2);
                txt_QueQuan_TacGia.setText(tg.getQueQuan());
            }}
                
        } catch (Exception e) {
            e.printStackTrace();
            JOptionPane.showMessageDialog(null, e.getStackTrace(),"Lỗi",JOptionPane.ERROR_MESSAGE);
        }
    }//GEN-LAST:event_tbl_DanhSachTG_TacGiaMouseClicked

    private void btn_ThemTG_TacGiaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_ThemTG_TacGiaActionPerformed
        txt_MaTG_TacGia.setText(tuDongLayMa());
        StringBuilder sb = new StringBuilder();
        //MessageDialogHelper.showMessageDialog(null, (String) cbx_MaTK_T.getSelectedItem(), "Thông báo");
        DataValidator.validateEmptyTenNV(txt_TenTG_TacGia, sb);
        DataValidator.validateEmpty(dc_NgaySinh_TacGia, sb, "Ngày sinh không được để trống và theo định dạng MM-dd-yyyy");
        DataValidator.validateEmptyDiaChi(txt_QueQuan_TacGia, sb);
        
        if(sb.length()>0)
        {
            MessageDialogHelper.showErrorDialog(null, sb.toString(), "Lỗi");
            return;
        }

        try {
            TacGia tg = new TacGia();
            tg.setMaTacGia(txt_MaTG_TacGia.getText());
            tg.setTenTacGia(txt_TenTG_TacGia.getText());
            
            tg.setNgaySinh(((JTextField)dc_NgaySinh_TacGia.getDateEditor().getUiComponent()).getText());//
            tg.setQueQuan(txt_QueQuan_TacGia.getText());
            

            TacGiaDao dao =new TacGiaDao();
            if(dao.insert(tg))
            {
                resetTable();
                MessageDialogHelper.showMessageDialog(null, "Tác giả thêm thành công", "Thông báo");
                resetThongTin();
                
            }
            else{
                MessageDialogHelper.showConfirmDialog(null, "Tác giả không lưu được do lỗi", "Cảnh báo");
                
            }

        } catch (Exception e) {
            e.printStackTrace();
            MessageDialogHelper.showErrorDialog( null, e.getMessage()
                , "Lỗi");
        }
    }//GEN-LAST:event_btn_ThemTG_TacGiaActionPerformed
    
    private void btn_Xoa_TacGiaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_Xoa_TacGiaActionPerformed
        //StringBuilder sb = new StringBuilder();
        //Kiểm tra có chọn trong table
        String maTG = "" ;
        try {
            int row = tbl_DanhSachTG_TacGia.getSelectedRow();

            if(row>=0)
            {
                String id = (String) tblModel.getValueAt(row , 0);
                maTG = JOptionPane.showInputDialog("Nhập mã tác giả muốn xóa",id);
            }else{
                maTG = JOptionPane.showInputDialog("Nhập mã tác giả muốn xóa");
            }
        } catch (Exception e) {
        }
        //Xóa nhân viên

        //JOptionPane.showMessageDialog(null, maNhanVien==null);
        if((maTG==null)==false)
        {
            if(maTG.equals("")==false)
            {if(MessageDialogHelper.showConfirmDialog(null, "Bạn có muốn xóa tác giả không?", "Hỏi")==JOptionPane.YES_OPTION)
                {}else{return;}
                try {

                    TacGiaDao dao =new TacGiaDao();

                    if(dao.delete(maTG))
                    {

                        MessageDialogHelper.showMessageDialog(null, "Xóa tác giả thành công", "Thông báo");
                        resetTable();

                    }
                    else{
                        MessageDialogHelper.showConfirmDialog(null, "Xóa tác giả không được do lỗi", "Cảnh báo");
                    }

                } catch (Exception e) {
                    e.printStackTrace();
                    MessageDialogHelper.showErrorDialog( null, e.getMessage()
                        , "Lỗi");
                }
            }
        }
    }//GEN-LAST:event_btn_Xoa_TacGiaActionPerformed

    private void btn_CapNhap_TacGiaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_CapNhap_TacGiaActionPerformed
      StringBuilder sb = new StringBuilder();
      TacGiaDao dao =new TacGiaDao();
        
        DataValidator.validateEmptyMaTG(txt_MaTG_TacGia, sb);        
        DataValidator.validateEmptyTenNV(txt_TenTG_TacGia, sb);
        DataValidator.validateEmpty(dc_NgaySinh_TacGia, sb, "Ngày sinh không được để trống và theo định dạng MM/dd/yyyy");
        DataValidator.validateEmptyDiaChi(txt_QueQuan_TacGia, sb);
        
        if(sb.length()>0)
        {
            MessageDialogHelper.showErrorDialog(null, sb.toString(), "Lỗi");
            return;
        }
        try {
             TacGia text = dao.find(txt_MaTG_TacGia.getText());
             if(text==null)
             {
                 MessageDialogHelper.showErrorDialog(null, "Mã tác giả không tồn tại", "Lỗi");
                 return ;}
         } catch (Exception ex) {
             Logger.getLogger(TacGiaForm.class.getName()).log(Level.SEVERE, null, ex);
         }
        if(MessageDialogHelper.showConfirmDialog(null, "Bạn có muốn cập nhân tác giả không?", "Hỏi")==JOptionPane.YES_OPTION)
        {}else{return;}
        try {
            TacGia tg =new TacGia();
            tg.setMaTacGia(txt_MaTG_TacGia.getText());
            tg.setTenTacGia(txt_TenTG_TacGia.getText());
            
            tg.setNgaySinh(((JTextField)dc_NgaySinh_TacGia.getDateEditor().getUiComponent()).getText());
            tg.setQueQuan(txt_QueQuan_TacGia.getText());
            
            

            if(dao.update(tg))
            {
                resetTable();
                MessageDialogHelper.showMessageDialog(null, "Cập nhập tác giả thành công", "Thông báo");
                resetThongTin();
            }
            else{
                MessageDialogHelper.showConfirmDialog(null, "Cập nhập tác giả không được do lỗi", "Cảnh báo");
                
            }

        } catch (Exception e) {
            e.printStackTrace();
            MessageDialogHelper.showErrorDialog( null, e.getMessage()
                , "Lỗi");
        }
    }//GEN-LAST:event_btn_CapNhap_TacGiaActionPerformed

    private void btn_CapNhapBang_TacGiaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_CapNhapBang_TacGiaActionPerformed
         resetTable();
    }//GEN-LAST:event_btn_CapNhapBang_TacGiaActionPerformed

    private void btn_XoaTT_TacGiaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_XoaTT_TacGiaActionPerformed
        resetThongTin();
    }//GEN-LAST:event_btn_XoaTT_TacGiaActionPerformed
    private void resetTable() {
        tblModel.setRowCount(0);
        loadDataToTable();
    }
    private void initTable()
    {
        tblModel = new DefaultTableModel();
        tblModel.setColumnIdentifiers(new String [] {"Mã Tác Giả","Tên Tác Giả","Ngày Sinh","Quê Quán"});
        tbl_DanhSachTG_TacGia.setModel(tblModel);
        
    }
    private void loadDataToTable()
    {
        try {
            TacGiaDao dao = new TacGiaDao();
            List<TacGia> list = dao.findAll();
            tblModel.setRowCount(0);
            for(TacGia it : list)
            {
                
               
                tblModel.addRow(new Object[]
                { it.getMaTacGia(),it.getTenTacGia(),it.getNgaySinh(),it.getQueQuan()} );
                
                tblModel.fireTableDataChanged();
            }
        } catch (Exception e) {
            e.printStackTrace();
            MessageDialogHelper.showErrorDialog(null, e.getMessage(), "Lỗi");
                 
        }
    }
    public String tuDongLayMa() {
		String maTG = "";
		try {
			Connection con = ConnectDB.getInstance().getConnection();
			String sql = " DECLARE @ID VARCHAR(5)\r\n"
					+ " IF (SELECT COUNT(maTacGia) FROM TacGia) = 0\r\n"
					+ " SET @ID = '0'\r\n" 
                                        + " ELSE\r\n"
					+ " SELECT @ID = MAX(RIGHT(rtrim(maTacGia), 3)) FROM TacGia\r\n"
                                        + " SELECT @ID = CASE\r\n"
                                        + " WHEN @ID >= 0 and @ID < 9 THEN 'TG00' + CONVERT(CHAR, CONVERT(INT, @ID) + 1)\r\n"      
                                        + " WHEN @ID >= 9 THEN 'TG0' + CONVERT(CHAR, CONVERT(INT, @ID) + 1)\r\n"
                                        + " END\r\n"
                                        + " select @ID" ;       		
                                
			Statement statement = con.createStatement();
			ResultSet rs = statement.executeQuery(sql);
			while (rs.next()) {
				String ID = rs.getString(1);
				maTG = ID;
			}
		} catch (SQLException e) {
			// TODO: handle exception
			e.printStackTrace();
		}
		return maTG;
	}
     private void resetThongTin() throws HeadlessException {
        resetTextFiled(txt_MaTG_TacGia);
        resetTextFiled(txt_TenTG_TacGia);
        resetTextFiled(dc_NgaySinh_TacGia);
        resetTextFiled(txt_QueQuan_TacGia);
        
    }
     private void resetTextFiled(JDateChooser field) {
         field.setDate(null);
         field.setBackground(Color.white);//To change body of generated methods, choose Tools | Templates.
    }
     private void resetTextFiled(JTextField field) throws HeadlessException {
       field.setText("");
       field.setBackground(Color.white);
    }
     
    private void btn_TimKiem_TK_TacGiaActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_TimKiem_TK_TacGiaActionPerformed
       try {
            TacGiaDao dao = new TacGiaDao();
            String TG = txt_MaTG_TK_TacGia.getText();
            String maTG = dao.findMaTacGiaByTen(TG)==null?"":dao.findMaTacGiaByTen(TG).getMaTacGia();
            List<TacGia> list = dao.findDK(maTG,((JTextField)dc_NgaySinh_TK_TacGia.getDateEditor().getUiComponent()).getText());
                   
            tblModel.setRowCount(0);
            for(TacGia it : list)
            {
                
                
                tblModel.addRow(new Object[]
                { it.getMaTacGia(),it.getTenTacGia(),it.getNgaySinh(),it.getQueQuan()} );
                
                tblModel.fireTableDataChanged();
            }
        } catch (Exception e) {
            e.printStackTrace();
            MessageDialogHelper.showErrorDialog(null, e.getMessage(), "Lỗi");

        }
    }//GEN-LAST:event_btn_TimKiem_TK_TacGiaActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btn_CapNhapBang_TacGia;
    private javax.swing.JButton btn_CapNhap_TacGia;
    private javax.swing.JButton btn_ThemTG_TacGia;
    private javax.swing.JButton btn_TimKiem_TK_TacGia;
    private javax.swing.JButton btn_XoaTT_TacGia;
    private javax.swing.JButton btn_Xoa_TacGia;
    private com.toedter.calendar.JDateChooser dc_NgaySinh_TK_TacGia;
    private com.toedter.calendar.JDateChooser dc_NgaySinh_TacGia;
    private javax.swing.JLabel lbl_MaTG_TacGia;
    private javax.swing.JLabel lbl_NgaySinh_TacGia;
    private javax.swing.JLabel lbl_NhapMa_TacGia;
    private javax.swing.JLabel lbl_Quequan_TacGia;
    private javax.swing.JLabel lbl_TenForm_TacGia;
    private javax.swing.JLabel lbl_TenTG_TK_TacGia;
    private javax.swing.JLabel lbl_TenTG_TacGia;
    private javax.swing.JPanel pn_ChucNang_TacGia;
    private javax.swing.JPanel pn_TTSP_TacGia;
    private javax.swing.JPanel pn_TenForm_TacGia;
    private javax.swing.JPanel pn_TimKiem_TacGia;
    private javax.swing.JScrollPane scp_DanhSachTG_TacGia;
    private javax.swing.JTable tbl_DanhSachTG_TacGia;
    private javax.swing.JTextField txt_MaTG_TK_TacGia;
    private javax.swing.JTextField txt_MaTG_TacGia;
    private javax.swing.JTextField txt_QueQuan_TacGia;
    private javax.swing.JTextField txt_TenTG_TacGia;
    // End of variables declaration//GEN-END:variables
}
