/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package com.mycompany.quanlynhanvien.ui;

import com.mycompany.quanlynhanvien.Dao.NhaCungCapDao;
import com.mycompany.quanlynhanvien.Dao.NhomSanPhamDao;
import com.mycompany.quanlynhanvien.Dao.SanPhamDao;
import com.mycompany.quanlynhanvien.Dao.TacGiaDao;
import com.mycompany.quanlynhanvien.Helpers.ConnectDB;
import com.mycompany.quanlynhanvien.Helpers.DataValidator;
import com.mycompany.quanlynhanvien.Helpers.MessageDialogHelper;
import com.mycompany.quanlynhanvien.model.NhaCungCap;
import com.mycompany.quanlynhanvien.model.SanPham;
import com.mycompany.quanlynhanvien.model.TacGia;
import java.awt.Color;
import java.awt.HeadlessException;
import java.sql.Connection;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;
import java.util.logging.Level;
import java.util.logging.Logger;
import javax.swing.ImageIcon;
import javax.swing.JLabel;
import javax.swing.JOptionPane;
import javax.swing.JTextField;
import javax.swing.table.DefaultTableModel;

/**
 *
 * @author User
 */
public class NhaCungCapForm extends javax.swing.JPanel {
    private DefaultTableModel tblModel;
    /**
     * Creates new form NhaCungCapForm
     */
    public NhaCungCapForm() {
        initComponents();
        initTable();
        loadDataToTable();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        pn_TenForm_NCC = new javax.swing.JPanel();
        lbl_TenForm_NCC = new javax.swing.JLabel();
        pn_TTSP_NCC = new javax.swing.JPanel();
        lbl_MaNCC_NCC = new javax.swing.JLabel();
        lbl_TenNCC_NCC = new javax.swing.JLabel();
        lbl_Email_NCC = new javax.swing.JLabel();
        txt_Email_NCC = new javax.swing.JTextField();
        txt_MaNCC_NCC = new javax.swing.JTextField();
        txt_TenNCC_NCC = new javax.swing.JTextField();
        lbl_DiaChi_NCC = new javax.swing.JLabel();
        lbl_SDT_NCC = new javax.swing.JLabel();
        txt_DiaChi_NCC = new javax.swing.JTextField();
        txt_SDT_NCC = new javax.swing.JTextField();
        scp_DanhSachNCC_NCC = new javax.swing.JScrollPane();
        tbl_DanhSachNCC_NCC = new javax.swing.JTable();
        pn_ChucNang_NCC = new javax.swing.JPanel();
        btn_ThemNCC_NCC = new javax.swing.JButton();
        btn_Xoa_NCC = new javax.swing.JButton();
        btn_CapNhap_NCC = new javax.swing.JButton();
        btn_CapNhapBang_NCC = new javax.swing.JButton();
        btn_XoaTT_NCC = new javax.swing.JButton();
        pn_TimKiem_NCC = new javax.swing.JPanel();
        lbl_NhapMa_NCC = new javax.swing.JLabel();
        txt_Ma_TK_NCC = new javax.swing.JTextField();
        lbl_NhomSP_TK_NCC = new javax.swing.JLabel();
        btn_TimKiem_TK_NCC = new javax.swing.JButton();
        txt_SDT_TK_NCC = new javax.swing.JTextField();

        setMinimumSize(new java.awt.Dimension(1341, 708));
        setName(""); // NOI18N

        lbl_TenForm_NCC.setBackground(new java.awt.Color(255, 255, 255));
        lbl_TenForm_NCC.setFont(new java.awt.Font("Tahoma", 0, 24)); // NOI18N
        lbl_TenForm_NCC.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lbl_TenForm_NCC.setText("Nhà Cung Cấp");
        lbl_TenForm_NCC.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.RAISED));

        javax.swing.GroupLayout pn_TenForm_NCCLayout = new javax.swing.GroupLayout(pn_TenForm_NCC);
        pn_TenForm_NCC.setLayout(pn_TenForm_NCCLayout);
        pn_TenForm_NCCLayout.setHorizontalGroup(
            pn_TenForm_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_TenForm_NCCLayout.createSequentialGroup()
                .addComponent(lbl_TenForm_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 1280, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(0, 20, Short.MAX_VALUE))
        );
        pn_TenForm_NCCLayout.setVerticalGroup(
            pn_TenForm_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(lbl_TenForm_NCC, javax.swing.GroupLayout.DEFAULT_SIZE, 42, Short.MAX_VALUE)
        );

        pn_TTSP_NCC.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Thông tin sản phẩm", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 12))); // NOI18N

        lbl_MaNCC_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_MaNCC_NCC.setText("Mã nhà cung cấp:");

        lbl_TenNCC_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_TenNCC_NCC.setText("Tên nhà cung cấp:");

        lbl_Email_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_Email_NCC.setText("Email:");

        txt_Email_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        txt_Email_NCC.setMinimumSize(new java.awt.Dimension(7, 25));
        txt_Email_NCC.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txt_Email_NCCActionPerformed(evt);
            }
        });

        txt_MaNCC_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        txt_MaNCC_NCC.setMinimumSize(new java.awt.Dimension(7, 25));

        txt_TenNCC_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N

        lbl_DiaChi_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_DiaChi_NCC.setText("Địa chỉ:");

        lbl_SDT_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_SDT_NCC.setText("Số điện thoại:");

        txt_DiaChi_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N

        txt_SDT_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N

        javax.swing.GroupLayout pn_TTSP_NCCLayout = new javax.swing.GroupLayout(pn_TTSP_NCC);
        pn_TTSP_NCC.setLayout(pn_TTSP_NCCLayout);
        pn_TTSP_NCCLayout.setHorizontalGroup(
            pn_TTSP_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_TTSP_NCCLayout.createSequentialGroup()
                .addGap(41, 41, 41)
                .addGroup(pn_TTSP_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addGroup(pn_TTSP_NCCLayout.createSequentialGroup()
                        .addGroup(pn_TTSP_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                            .addComponent(lbl_TenNCC_NCC)
                            .addComponent(lbl_Email_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 62, javax.swing.GroupLayout.PREFERRED_SIZE))
                        .addGap(30, 30, 30)
                        .addGroup(pn_TTSP_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                            .addComponent(txt_Email_NCC, javax.swing.GroupLayout.DEFAULT_SIZE, 351, Short.MAX_VALUE)
                            .addComponent(txt_TenNCC_NCC)))
                    .addGroup(pn_TTSP_NCCLayout.createSequentialGroup()
                        .addComponent(lbl_MaNCC_NCC)
                        .addGap(35, 35, 35)
                        .addComponent(txt_MaNCC_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 350, javax.swing.GroupLayout.PREFERRED_SIZE)))
                .addGap(96, 96, 96)
                .addGroup(pn_TTSP_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(lbl_SDT_NCC)
                    .addComponent(lbl_DiaChi_NCC))
                .addGap(28, 28, 28)
                .addGroup(pn_TTSP_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(txt_SDT_NCC, javax.swing.GroupLayout.DEFAULT_SIZE, 354, Short.MAX_VALUE)
                    .addComponent(txt_DiaChi_NCC))
                .addGap(186, 186, 186))
        );
        pn_TTSP_NCCLayout.setVerticalGroup(
            pn_TTSP_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_TTSP_NCCLayout.createSequentialGroup()
                .addGap(15, 15, 15)
                .addGroup(pn_TTSP_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbl_MaNCC_NCC)
                    .addComponent(txt_MaNCC_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lbl_DiaChi_NCC)
                    .addComponent(txt_DiaChi_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, Short.MAX_VALUE)
                .addGroup(pn_TTSP_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(txt_TenNCC_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lbl_TenNCC_NCC)
                    .addComponent(lbl_SDT_NCC)
                    .addComponent(txt_SDT_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(18, 18, 18)
                .addGroup(pn_TTSP_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbl_Email_NCC)
                    .addComponent(txt_Email_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(150, 150, 150))
        );

        tbl_DanhSachNCC_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        tbl_DanhSachNCC_NCC.setModel(new javax.swing.table.DefaultTableModel(
            new Object [][] {
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null},
                {null, null, null, null, null, null, null}
            },
            new String [] {
                "Mã NV", "Tên Nhân Viên", "Giới tính", "Ngày sinh", "Số điện thoại", "Chức vụ", "Tình trạng"
            }
        ) {
            Class[] types = new Class [] {
                java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.String.class, java.lang.Boolean.class
            };

            public Class getColumnClass(int columnIndex) {
                return types [columnIndex];
            }
        });
        tbl_DanhSachNCC_NCC.setCursor(new java.awt.Cursor(java.awt.Cursor.DEFAULT_CURSOR));
        tbl_DanhSachNCC_NCC.setName("Danh sách nhân viên\n"); // NOI18N
        tbl_DanhSachNCC_NCC.addFocusListener(new java.awt.event.FocusAdapter() {
            public void focusLost(java.awt.event.FocusEvent evt) {
                tbl_DanhSachNCC_NCCFocusLost(evt);
            }
        });
        tbl_DanhSachNCC_NCC.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                tbl_DanhSachNCC_NCCMouseClicked(evt);
            }
        });
        scp_DanhSachNCC_NCC.setViewportView(tbl_DanhSachNCC_NCC);

        btn_ThemNCC_NCC.setBackground(new java.awt.Color(51, 255, 51));
        btn_ThemNCC_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_ThemNCC_NCC.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-identification-documents-24.png"))); // NOI18N
        btn_ThemNCC_NCC.setText("Thêm sản phẩm");
        btn_ThemNCC_NCC.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btn_ThemNCC_NCC.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_ThemNCC_NCCActionPerformed(evt);
            }
        });

        btn_Xoa_NCC.setBackground(new java.awt.Color(51, 255, 51));
        btn_Xoa_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_Xoa_NCC.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-user-24.png"))); // NOI18N
        btn_Xoa_NCC.setText("-  Xóa sản phẩm");
        btn_Xoa_NCC.setHorizontalAlignment(javax.swing.SwingConstants.LEFT);
        btn_Xoa_NCC.setMinimumSize(new java.awt.Dimension(93, 25));
        btn_Xoa_NCC.setPreferredSize(new java.awt.Dimension(93, 25));
        btn_Xoa_NCC.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_Xoa_NCCActionPerformed(evt);
            }
        });

        btn_CapNhap_NCC.setBackground(new java.awt.Color(102, 255, 102));
        btn_CapNhap_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_CapNhap_NCC.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-pencil-24.png"))); // NOI18N
        btn_CapNhap_NCC.setText("Cập nhập sản phẩm");
        btn_CapNhap_NCC.setFocusable(false);
        btn_CapNhap_NCC.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btn_CapNhap_NCC.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_CapNhap_NCCActionPerformed(evt);
            }
        });

        btn_CapNhapBang_NCC.setBackground(new java.awt.Color(51, 255, 51));
        btn_CapNhapBang_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_CapNhapBang_NCC.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-easel-24.png"))); // NOI18N
        btn_CapNhapBang_NCC.setText("Cập nhập lại bảng");
        btn_CapNhapBang_NCC.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_CapNhapBang_NCCActionPerformed(evt);
            }
        });

        btn_XoaTT_NCC.setBackground(new java.awt.Color(51, 255, 51));
        btn_XoaTT_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_XoaTT_NCC.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-identification-documents-24.png"))); // NOI18N
        btn_XoaTT_NCC.setText("Xóa thông tin");
        btn_XoaTT_NCC.setHorizontalTextPosition(javax.swing.SwingConstants.RIGHT);
        btn_XoaTT_NCC.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_XoaTT_NCCActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout pn_ChucNang_NCCLayout = new javax.swing.GroupLayout(pn_ChucNang_NCC);
        pn_ChucNang_NCC.setLayout(pn_ChucNang_NCCLayout);
        pn_ChucNang_NCCLayout.setHorizontalGroup(
            pn_ChucNang_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_ChucNang_NCCLayout.createSequentialGroup()
                .addGap(51, 51, 51)
                .addComponent(btn_XoaTT_NCC)
                .addGap(95, 95, 95)
                .addComponent(btn_ThemNCC_NCC)
                .addGap(92, 92, 92)
                .addComponent(btn_Xoa_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 171, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(84, 84, 84)
                .addComponent(btn_CapNhap_NCC)
                .addGap(68, 68, 68)
                .addComponent(btn_CapNhapBang_NCC)
                .addContainerGap(71, Short.MAX_VALUE))
        );
        pn_ChucNang_NCCLayout.setVerticalGroup(
            pn_ChucNang_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_ChucNang_NCCLayout.createSequentialGroup()
                .addGap(8, 8, 8)
                .addGroup(pn_ChucNang_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(btn_CapNhap_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn_CapNhapBang_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn_ThemNCC_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn_Xoa_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(btn_XoaTT_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(8, 8, 8))
        );

        pn_TimKiem_NCC.setBorder(javax.swing.BorderFactory.createTitledBorder(null, "Tìm kiếm", javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Tahoma", 0, 12))); // NOI18N

        lbl_NhapMa_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_NhapMa_NCC.setText("Mã nhóm sản phẩm:");

        txt_Ma_TK_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N

        lbl_NhomSP_TK_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        lbl_NhomSP_TK_NCC.setText("Tên nhóm sản phẩm");

        btn_TimKiem_TK_NCC.setBackground(new java.awt.Color(51, 255, 51));
        btn_TimKiem_TK_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N
        btn_TimKiem_TK_NCC.setIcon(new javax.swing.ImageIcon(getClass().getResource("/com/mycompany/quanlynhanvien/icons/icons8-search-24.png"))); // NOI18N
        btn_TimKiem_TK_NCC.setText("Tìm kiếm");
        btn_TimKiem_TK_NCC.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btn_TimKiem_TK_NCCActionPerformed(evt);
            }
        });

        txt_SDT_TK_NCC.setFont(new java.awt.Font("Tahoma", 0, 14)); // NOI18N

        javax.swing.GroupLayout pn_TimKiem_NCCLayout = new javax.swing.GroupLayout(pn_TimKiem_NCC);
        pn_TimKiem_NCC.setLayout(pn_TimKiem_NCCLayout);
        pn_TimKiem_NCCLayout.setHorizontalGroup(
            pn_TimKiem_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_TimKiem_NCCLayout.createSequentialGroup()
                .addGap(41, 41, 41)
                .addComponent(lbl_NhapMa_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 138, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                .addComponent(txt_Ma_TK_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 325, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(72, 72, 72)
                .addComponent(lbl_NhomSP_TK_NCC)
                .addGap(31, 31, 31)
                .addComponent(txt_SDT_TK_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 271, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, 85, Short.MAX_VALUE)
                .addComponent(btn_TimKiem_TK_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 125, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addGap(28, 28, 28))
        );
        pn_TimKiem_NCCLayout.setVerticalGroup(
            pn_TimKiem_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(pn_TimKiem_NCCLayout.createSequentialGroup()
                .addGap(5, 5, 5)
                .addGroup(pn_TimKiem_NCCLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                    .addComponent(lbl_NhapMa_NCC)
                    .addComponent(txt_Ma_TK_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(lbl_NhomSP_TK_NCC)
                    .addComponent(btn_TimKiem_TK_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 41, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(txt_SDT_TK_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 30, javax.swing.GroupLayout.PREFERRED_SIZE))
                .addGap(5, 5, 5))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(this);
        this.setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(layout.createSequentialGroup()
                .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                    .addComponent(pn_TimKiem_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addComponent(pn_TenForm_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                    .addGroup(layout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING, false)
                        .addComponent(scp_DanhSachNCC_NCC, javax.swing.GroupLayout.Alignment.LEADING)
                        .addComponent(pn_ChucNang_NCC, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                        .addComponent(pn_TTSP_NCC, javax.swing.GroupLayout.Alignment.LEADING, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
                .addContainerGap(37, Short.MAX_VALUE))
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, layout.createSequentialGroup()
                .addGap(0, 0, 0)
                .addComponent(pn_TenForm_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(pn_TimKiem_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(pn_TTSP_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, 176, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(pn_ChucNang_NCC, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED)
                .addComponent(scp_DanhSachNCC_NCC, javax.swing.GroupLayout.DEFAULT_SIZE, 325, Short.MAX_VALUE)
                .addContainerGap())
        );
    }// </editor-fold>//GEN-END:initComponents

    private void txt_Email_NCCActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txt_Email_NCCActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txt_Email_NCCActionPerformed

    private void tbl_DanhSachNCC_NCCFocusLost(java.awt.event.FocusEvent evt) {//GEN-FIRST:event_tbl_DanhSachNCC_NCCFocusLost

    }//GEN-LAST:event_tbl_DanhSachNCC_NCCFocusLost

    private void tbl_DanhSachNCC_NCCMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_tbl_DanhSachNCC_NCCMouseClicked
        try {
            int row = tbl_DanhSachNCC_NCC.getSelectedRow();
            //MessageDialogHelper.showConfirmDialog(null, ""+row, "Cảnh báo");
            if(row>=0)
            {
                String id = (String) tbl_DanhSachNCC_NCC.getValueAt(row, 0);
                NhaCungCapDao dao = new NhaCungCapDao();
                NhaCungCap ncc = dao.find(id);

                if(ncc!=null)
                {
                txt_MaNCC_NCC.setText(ncc.getMaNhaCC().replaceAll("\\s",""));
                txt_TenNCC_NCC.setText(ncc.getTenNhaCC());
                txt_DiaChi_NCC.setText(ncc.getDiaChi());
                txt_SDT_NCC.setText(ncc.getsDT().replaceAll("\\s",""));
                txt_Email_NCC.setText(ncc.getEmail().replaceAll("\\s",""));
                    
                }}

            } catch (Exception e) {
                e.printStackTrace();
                JOptionPane.showMessageDialog(null, e.getStackTrace(),"Lỗi",JOptionPane.ERROR_MESSAGE);
            }
    }//GEN-LAST:event_tbl_DanhSachNCC_NCCMouseClicked

    private void btn_ThemNCC_NCCActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_ThemNCC_NCCActionPerformed
        txt_MaNCC_NCC.setText(tuDongLayMa());
        StringBuilder sb = new StringBuilder();
        //MessageDialogHelper.showMessageDialog(null, (String) cbx_MaTK_T.getSelectedItem(), "Thông báo");
        DataValidator.validateEmptyTenNV(txt_TenNCC_NCC, sb);
        
        DataValidator.validateEmptyDiaChi(txt_DiaChi_NCC, sb);
        DataValidator.validateEmptySDT(txt_SDT_NCC, sb);
        DataValidator.validateEmptyEmail(txt_Email_NCC, sb);
        
        if(sb.length()>0)
        {
            MessageDialogHelper.showErrorDialog(null, sb.toString(), "Lỗi");
            return;
        }

        try {
            NhaCungCap ncc = new NhaCungCap();
            ncc.setMaNhaCC(txt_MaNCC_NCC.getText());
            ncc.setTenNhaCC(txt_TenNCC_NCC.getText());
            
            ncc.setDiaChi(txt_DiaChi_NCC.getText());//
            ncc.setsDT(txt_SDT_NCC.getText());
            ncc.setEmail(txt_Email_NCC.getText());
            

            NhaCungCapDao dao =new NhaCungCapDao();
            if(dao.insert(ncc))
            {
                resetTable();
                MessageDialogHelper.showMessageDialog(null, "Thêm nhà cung cấp thành công", "Thông báo");
                resetThongTin();
                
            }
            else{
                MessageDialogHelper.showConfirmDialog(null, "Không tác giả  lưu được do lỗi", "Cảnh báo");
                
            }

        } catch (Exception e) {
            e.printStackTrace();
            MessageDialogHelper.showErrorDialog( null, e.getMessage()
                , "Lỗi");
        }
    }//GEN-LAST:event_btn_ThemNCC_NCCActionPerformed

    private void btn_Xoa_NCCActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_Xoa_NCCActionPerformed
        //StringBuilder sb = new StringBuilder();
        //Kiểm tra có chọn trong table
        String maNCC = "" ;
        try {
            int row = tbl_DanhSachNCC_NCC.getSelectedRow();

            if(row>=0)
            {
                String id = (String) tblModel.getValueAt(row , 0);
                maNCC = JOptionPane.showInputDialog("Nhập mã nhà cung cấp muốn xóa",id);
            }else{
                maNCC = JOptionPane.showInputDialog("Nhập mã nhà cung cấp muốn xóa");
            }
        } catch (Exception e) {
        }
        //Xóa nhân viên

        //JOptionPane.showMessageDialog(null, maNhanVien==null);
        if((maNCC==null)==false)
        {
            if(maNCC.equals("")==false)
            {if(MessageDialogHelper.showConfirmDialog(null, "Bạn có muốn xóa nhà cung cấp không?", "Hỏi")==JOptionPane.YES_OPTION)
                {}else{return;}
                try {

                    NhaCungCapDao dao =new NhaCungCapDao();

                    if(dao.delete(maNCC))
                    {

                        MessageDialogHelper.showMessageDialog(null, "Xóa nhà cung cấp thành công", "Thông báo");
                        resetTable();
                    }
                    else{
                        MessageDialogHelper.showConfirmDialog(null, "Xóa nhà cung cấp không được do lỗi", "Cảnh báo");
                    }

                } catch (Exception e) {
                    e.printStackTrace();
                    MessageDialogHelper.showErrorDialog( null, e.getMessage()
                        , "Lỗi");
                }
            }
        }
    }//GEN-LAST:event_btn_Xoa_NCCActionPerformed

    private void btn_CapNhap_NCCActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_CapNhap_NCCActionPerformed
        StringBuilder sb = new StringBuilder();
        NhaCungCapDao dao =new NhaCungCapDao();
        
        DataValidator.validateEmptyMaNCC(txt_MaNCC_NCC, sb);        
        DataValidator.validateEmptyTenNV(txt_TenNCC_NCC, sb);       
        DataValidator.validateEmptyDiaChi(txt_DiaChi_NCC, sb);
        DataValidator.validateEmptySDT(txt_SDT_NCC, sb);
        DataValidator.validateEmptyEmail(txt_Email_NCC, sb);
        if(sb.length()>0)
        {
            MessageDialogHelper.showErrorDialog(null, sb.toString(), "Lỗi");
            return;
        }
        try {
             NhaCungCap text = dao.find(txt_MaNCC_NCC.getText());
             if(text==null)
             {
                 MessageDialogHelper.showErrorDialog(null, "Mã nhà cung cấp không tồn tại", "Lỗi");
                 return ;}
         } catch (Exception ex) {
             Logger.getLogger(TacGiaForm.class.getName()).log(Level.SEVERE, null, ex);
         }
        if(MessageDialogHelper.showConfirmDialog(null, "Bạn có muốn cập nhân nhà cung cấp không?", "Hỏi")==JOptionPane.YES_OPTION)
        {}else{return;}
        try {
            NhaCungCap ncc =new NhaCungCap();
            ncc.setMaNhaCC(txt_MaNCC_NCC.getText());
            ncc.setTenNhaCC(txt_TenNCC_NCC.getText());
            
            ncc.setDiaChi(txt_DiaChi_NCC.getText());
            ncc.setsDT(txt_SDT_NCC.getText());
            ncc.setEmail(txt_Email_NCC.getText());
            
            

            if(dao.update(ncc))
            {
                resetTable();
                MessageDialogHelper.showMessageDialog(null, "Cập nhập nhà cung cấp thành công", "Thông báo");
                resetThongTin();
            }
            else{
                MessageDialogHelper.showConfirmDialog(null, "Cập nhập nhà cung cấp không được do lỗi", "Cảnh báo");
                
            }

        } catch (Exception e) {
            e.printStackTrace();
            MessageDialogHelper.showErrorDialog( null, e.getMessage()
                , "Lỗi");
        }
    }//GEN-LAST:event_btn_CapNhap_NCCActionPerformed

    private void btn_CapNhapBang_NCCActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_CapNhapBang_NCCActionPerformed
        resetTable();
    }//GEN-LAST:event_btn_CapNhapBang_NCCActionPerformed

    private void btn_XoaTT_NCCActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_XoaTT_NCCActionPerformed
         resetThongTin();
    }//GEN-LAST:event_btn_XoaTT_NCCActionPerformed

    private void btn_TimKiem_TK_NCCActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btn_TimKiem_TK_NCCActionPerformed
        try {
            NhaCungCapDao dao = new NhaCungCapDao();
            String NCC = txt_Ma_TK_NCC.getText();
            String maNCC = dao.findMaNhaCCByTen(NCC)==null?"":dao.findMaNhaCCByTen(NCC).getMaNhaCC();
            List<NhaCungCap> list = dao.findDK(maNCC,txt_SDT_TK_NCC.getText());
                   
            tblModel.setRowCount(0);
            for(NhaCungCap it : list)
            {
                
                
                tblModel.addRow(new Object[]
                { it.getMaNhaCC(),it.getTenNhaCC(),it.getDiaChi(),it.getsDT(),it.getEmail()} );
                
                tblModel.fireTableDataChanged();
            }
        } catch (Exception e) {
            e.printStackTrace();
            MessageDialogHelper.showErrorDialog(null, e.getMessage(), "Lỗi");

        }
    }//GEN-LAST:event_btn_TimKiem_TK_NCCActionPerformed
    private void resetThongTin() throws HeadlessException {
        resetTextFiled(txt_MaNCC_NCC);
        resetTextFiled(txt_TenNCC_NCC);
        resetTextFiled(txt_DiaChi_NCC);
        resetTextFiled(txt_SDT_NCC);
        resetTextFiled(txt_Email_NCC);
        
    }
    public String tuDongLayMa() {
		String maNCC = "";
		try {
			Connection con = ConnectDB.getInstance().getConnection();
			String sql = " DECLARE @ID VARCHAR(6)\r\n"
					+ " IF (SELECT COUNT(maNhaCC) FROM NhaCungCap) = 0\r\n"
					+ " SET @ID = '0'\r\n" 
                                        + " ELSE\r\n"
					+ " SELECT @ID = MAX(RIGHT(rtrim(maNhaCC), 3)) FROM NhaCungCap\r\n"
                                        + " SELECT @ID = CASE\r\n"
                                        + " WHEN @ID >= 0 and @ID < 9 THEN 'NCC00' + CONVERT(CHAR, CONVERT(INT, @ID) + 1)\r\n"      
                                        + " WHEN @ID >= 9 THEN 'NCC0' + CONVERT(CHAR, CONVERT(INT, @ID) + 1)\r\n"
                                        + " END\r\n"
                                        + " select @ID" ;       		
                                
			Statement statement = con.createStatement();
			ResultSet rs = statement.executeQuery(sql);
			while (rs.next()) {
				String ID = rs.getString(1);
				maNCC = ID;
			}
		} catch (SQLException e) {
			// TODO: handle exception
			e.printStackTrace();
		}
		return maNCC;
	}
    private void resetTable() {
        tblModel.setRowCount(0);
        loadDataToTable();
    }
    private void resetTextFiled(JTextField field) throws HeadlessException {
       field.setText("");
       field.setBackground(Color.white);
    }
    private void initTable()
    {
        tblModel = new DefaultTableModel();
        tblModel.setColumnIdentifiers(new String [] {"Mã Nhà Cung Cấp","Tên Nhà Cung Cấp","Địa chỉ","Số Điện thoại","Email"});
        tbl_DanhSachNCC_NCC.setModel(tblModel);
        
    }
    private void loadDataToTable()
    {
        try {
            NhaCungCapDao dao = new NhaCungCapDao();
            List<NhaCungCap> list = dao.findAll();
            tblModel.setRowCount(0);
            for(NhaCungCap it : list)
            {
                
               
                tblModel.addRow(new Object[]
                { it.getMaNhaCC(),it.getTenNhaCC(),it.getDiaChi(),it.getsDT(),it.getEmail()} );
                
                tblModel.fireTableDataChanged();
            }
        } catch (Exception e) {
            e.printStackTrace();
            MessageDialogHelper.showErrorDialog(null, e.getMessage(), "Lỗi");
                 
        }
    }

    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btn_CapNhapBang_NCC;
    private javax.swing.JButton btn_CapNhap_NCC;
    private javax.swing.JButton btn_ThemNCC_NCC;
    private javax.swing.JButton btn_TimKiem_TK_NCC;
    private javax.swing.JButton btn_XoaTT_NCC;
    private javax.swing.JButton btn_Xoa_NCC;
    private javax.swing.JLabel lbl_DiaChi_NCC;
    private javax.swing.JLabel lbl_Email_NCC;
    private javax.swing.JLabel lbl_MaNCC_NCC;
    private javax.swing.JLabel lbl_NhapMa_NCC;
    private javax.swing.JLabel lbl_NhomSP_TK_NCC;
    private javax.swing.JLabel lbl_SDT_NCC;
    private javax.swing.JLabel lbl_TenForm_NCC;
    private javax.swing.JLabel lbl_TenNCC_NCC;
    private javax.swing.JPanel pn_ChucNang_NCC;
    private javax.swing.JPanel pn_TTSP_NCC;
    private javax.swing.JPanel pn_TenForm_NCC;
    private javax.swing.JPanel pn_TimKiem_NCC;
    private javax.swing.JScrollPane scp_DanhSachNCC_NCC;
    private javax.swing.JTable tbl_DanhSachNCC_NCC;
    private javax.swing.JTextField txt_DiaChi_NCC;
    private javax.swing.JTextField txt_Email_NCC;
    private javax.swing.JTextField txt_MaNCC_NCC;
    private javax.swing.JTextField txt_Ma_TK_NCC;
    private javax.swing.JTextField txt_SDT_NCC;
    private javax.swing.JTextField txt_SDT_TK_NCC;
    private javax.swing.JTextField txt_TenNCC_NCC;
    // End of variables declaration//GEN-END:variables
}
